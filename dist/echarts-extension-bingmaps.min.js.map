{"version":3,"file":"echarts-extension-bingmaps.min.js","sources":["../lib/util.js","../lib/BingMapModel.js","../lib/BingMapView.js","../lib/BingMapCoordSys.js","../lib/index.js","../index.js"],"sourcesContent":["import { version } from 'echarts'\n\nexport const ecVer = version.split('.')\n\nexport const isNewEC = ecVer[0] > 4\n\nexport const COMPONENT_TYPE = 'bingmap'\n\nexport function v2Equal(a, b) {\n  return a && b && a[0] === b[0] && a[1] === b[1]\n}\n","import { ComponentModel } from 'echarts'\n\nimport { v2Equal, isNewEC, COMPONENT_TYPE } from './util';\n\nconst BingMapModel = {\n  type: COMPONENT_TYPE,\n  setBingMap: function (bingmap) {\n    this.__bingmap = bingmap;\n  },\n  getBingMap: function () {\n    return this.__bingmap;\n  },\n  setEChartsLayer: function (layer) {\n    this.__echartsLayer = layer;\n  },\n\n  getEChartsLayer: function () {\n    return this.__echartsLayer;\n  },\n  setCenterAndZoom: function (center, zoom) {\n    this.option.viewOption.center = center;\n    this.option.viewOption.zoom = zoom;\n  },\n  centerOrZoomChanged: function (center, zoom) {\n    let option = this.option.viewOption;\n    return !(v2Equal(center, option.center) && zoom === option.zoom);\n  },\n  defaultOption: {\n    viewOption: {\n      center: [113.493471, 23.169598],\n      zoom: 5,\n    },\n    mapOption: {\n      customMapStyle: {},\n    },\n  },\n}\n\nexport default isNewEC\n  ? ComponentModel.extend(BingMapModel)\n  : BingMapModel\n","import { ComponentView } from 'echarts'\nimport { COMPONENT_TYPE, isNewEC } from './util'\n\nconst BingMapView = {\n  type: COMPONENT_TYPE,\n  init() {\n    this._isFirstRender = true\n  },\n\n  render: function (bingMapModel, ecModel, api) {\n    let rendering = true;\n    let bingmap = bingMapModel.getBingMap();\n    let viewportRoot = api.getZr().painter.getViewportRoot();\n    let coordSys = bingMapModel.coordinateSystem;\n\n    let viewChangeHandler = function (arg) {\n      if (rendering) {\n        return;\n      }\n\n      let offsetEl = viewportRoot.parentNode.parentNode.parentNode;\n      let mapOffset = [\n        -parseInt(offsetEl.style.left, 10) || 0,\n        -parseInt(offsetEl.style.top, 10) || 0,\n      ];\n      viewportRoot.style.left = mapOffset[0] + 'px';\n      viewportRoot.style.top = mapOffset[1] + 'px';\n      coordSys.setMapOffset(mapOffset);\n      bingMapModel.__mapOffset = mapOffset;\n      api.dispatchAction({\n        type: 'bingmapRoam',\n      });\n    };\n    Microsoft.Maps.Events.removeHandler(this._oldViewChangeHandler);\n    this._oldViewChangeHandler = Microsoft.Maps.Events.addHandler(\n      bingmap,\n      'viewchangeend',\n      viewChangeHandler,\n    );\n    Microsoft.Maps.Events.removeHandler(this._oldmapresize);\n    this._oldmapresize = Microsoft.Maps.Events.addHandler(bingmap, 'mapresize', viewChangeHandler);\n    this._isFirstRender = rendering = false;\n    this.__viewChangeHandler = viewChangeHandler;\n  },\n  dispose() {\n    const component = this.__model\n    if (component) {\n      component.getBingMap().dispose()\n      component.setBingMap(null)\n      component.setEChartsLayer(null)\n      if (component.coordinateSystem) {\n        component.coordinateSystem.setBingMap(null)\n        component.coordinateSystem = null\n      }\n    }\n    delete this.__viewChangeHandler\n  }\n}\n\nexport default isNewEC\n  ? ComponentView.extend(BingMapView)\n  : BingMapView\n","import { util as zrUtil, graphic, matrix } from 'echarts';\nimport { COMPONENT_TYPE } from './util';\n\nfunction BingMapCoordSys(bingmap, api) {\n  this._bingmap = bingmap;\n  this.dimensions = ['lng', 'lat'];\n  this._mapOffset = [0, 0];\n  this._api = api;\n  this._type = COMPONENT_TYPE;\n}\n\nBingMapCoordSys.prototype.dimensions = ['lng', 'lat'];\n\nBingMapCoordSys.prototype.setZoom = function (zoom) {\n  this._zoom = zoom;\n};\n\nBingMapCoordSys.prototype.setCenter = function (center) {\n  this._center = this._bingmap.tryLocationToPixel(\n    new Microsoft.Maps.Location(center[1], center[0]),\n  );\n};\n\nBingMapCoordSys.prototype.setMapOffset = function (mapOffset) {\n  this._mapOffset = mapOffset;\n};\n\nBingMapCoordSys.prototype.getBingMap = function () {\n  return this._bingmap;\n};\n\nBingMapCoordSys.prototype.dataToPoint = function (data) {\n  let lnglat = new Microsoft.Maps.Location(data[1], data[0]);\n  let px = this._bingmap.tryLocationToPixel(lnglat, Microsoft.Maps.PixelReference.control);\n  let mapOffset = this._mapOffset;\n  return [px.x - mapOffset[0], px.y - mapOffset[1]];\n};\n\nBingMapCoordSys.prototype.pointToData = function (pt) {\n  let mapOffset = this._mapOffset;\n  const ptN = this._bingmap.tryPixelToLocation(\n    {\n      x: pt[0] + mapOffset[0],\n      y: pt[1] + mapOffset[1],\n    },\n    Microsoft.Maps.PixelReference.control,\n  );\n\n  return [ptN.longitude, ptN.latitude];\n};\n\nBingMapCoordSys.prototype.getViewRect = function () {\n  let api = this._api;\n  return new graphic.BoundingRect(0, 0, api.getWidth(), api.getHeight());\n};\n\nBingMapCoordSys.prototype.getRoamTransform = function () {\n  return matrix.create();\n};\n\nBingMapCoordSys.prototype.prepareCustoms = function () {\n  let rect = this.getViewRect();\n  return {\n    coordSys: {\n      type: COMPONENT_TYPE,\n      x: rect.x,\n      y: rect.y,\n      width: rect.width,\n      height: rect.height,\n    },\n    api: {\n      coord: zrUtil.bind(this.dataToPoint, this),\n      size: zrUtil.bind(dataToCoordSize, this),\n    },\n  };\n};\n\nfunction dataToCoordSize(dataSize, dataItem) {\n  dataItem = dataItem || [0, 0];\n  return zrUtil.map(\n    [0, 1],\n    function (dimIdx) {\n      let val = dataItem[dimIdx];\n      let halfSize = dataSize[dimIdx] / 2;\n      let p1 = [];\n      let p2 = [];\n      p1[dimIdx] = val - halfSize;\n      p2[dimIdx] = val + halfSize;\n      p1[1 - dimIdx] = p2[1 - dimIdx] = dataItem[1 - dimIdx];\n      return Math.abs(this.dataToPoint(p1)[dimIdx] - this.dataToPoint(p2)[dimIdx]);\n    },\n    this,\n  );\n}\n\nBingMapCoordSys.dimensions = BingMapCoordSys.prototype.dimensions;\n\nBingMapCoordSys.create = function (ecModel, api) {\n  let bingmapCoordSys;\n  let root = api.getDom();\n\n  ecModel.eachComponent(COMPONENT_TYPE, function (bingmapModel) {\n    let painter = api.getZr().painter;\n    let viewportRoot = painter.getViewportRoot();\n\n    if (\n      typeof Microsoft === 'undefined' ||\n      typeof Microsoft.Maps === 'undefined' ||\n      typeof Microsoft.Maps.Map === 'undefined'\n    ) {\n      throw new Error('It seems that Bing Map API has not been loaded completely yet.');\n    }\n\n    if (bingmapCoordSys) {\n      throw new Error('Only one bingmap component can exist');\n    }\n\n    if (!bingmapModel.__bingmap) {\n      let bingmapRoot = root.querySelector('.ec-extension-bing-map');\n      viewportRoot.className = 'ms-composite';\n      viewportRoot.style.visibility = 'hidden';\n      if (bingmapRoot) {\n        viewportRoot.style.left = '0px';\n        viewportRoot.style.top = '0px';\n        viewportRoot.style.width = '100%';\n        viewportRoot.style.height = '100%';\n        viewportRoot.style.position = 'absolute';\n        root.removeChild(bingmapRoot);\n      }\n      bingmapRoot = document.createElement('div');\n      bingmapRoot.style.cssText = 'position:absolute;top:0;left:0;right:0;bottom:0;';\n      bingmapRoot.className = 'ec-extension-bing-map';\n      root.appendChild(bingmapRoot);\n      const bingmap = (bingmapModel.__bingmap = new Microsoft.Maps.Map(bingmapRoot));\n      let mapOption = bingmapModel.get('mapOption') || {};\n      bingmap.setOptions(mapOption);\n      bingmapRoot.querySelector('.MicrosoftMap').appendChild(viewportRoot);\n      viewportRoot.style.visibility = '';\n      painter.getViewportRootOffset = function () {\n        return {\n          offsetLeft: 0,\n          offsetTop: 0,\n        };\n      };\n    }\n\n    const bingmap = bingmapModel.__bingmap;\n    let viewOption = bingmapModel.get('viewOption');\n    let { center, zoom } = viewOption;\n    let normalizedCenter = [\n      center.lng !== undefined ? center.lng : center[0],\n      center.lat !== undefined ? center.lat : center[1],\n    ];\n\n    if (center && zoom) {\n      let bingmapCenter = bingmap.getCenter();\n      let bingmapZoom = bingmap.getZoom();\n      let centerOrZoomChanged = bingmapModel.centerOrZoomChanged(\n        [bingmapCenter.longitude, bingmapCenter.latitude],\n        bingmapZoom,\n      );\n      if (centerOrZoomChanged) {\n        let pt = new Microsoft.Maps.Location(normalizedCenter[1], normalizedCenter[0]);\n        bingmap.setView({\n          center: pt,\n          zoom: zoom,\n        });\n      }\n    }\n\n    bingmapCoordSys = new BingMapCoordSys(bingmap, api);\n    bingmapCoordSys.setMapOffset(bingmapModel.__mapOffset || [0, 0]);\n    bingmapCoordSys.setZoom(zoom);\n    bingmapCoordSys.setCenter(center);\n    bingmapModel.coordinateSystem = bingmapCoordSys;\n  });\n  ecModel.eachSeries(function (seriesModel) {\n    if (seriesModel.get('coordinateSystem') === COMPONENT_TYPE) {\n      seriesModel.coordinateSystem = bingmapCoordSys;\n    }\n  });\n};\n\nexport default BingMapCoordSys;\n","import BingMapModel from './BingMapModel';\nimport BingMapView from './BingMapView';\nimport BingMapCoordSys from './BingMapCoordSys';\nimport { isNewEC, ecVer, COMPONENT_TYPE } from './util';\n\nexport { version, name } from '../package.json';\n\n/**\n * BingMap extension installer\n * @param {EChartsExtensionRegisters} registers\n */\nexport function install(registers) {\n  // add coordinate system support for pie series for ECharts < 5.4.0\n  if (!isNewEC || (ecVer[0] == 5 && ecVer[1] < 4)) {\n    registers.registerLayout(function (ecModel) {\n      ecModel.eachSeriesByType('pie', function (seriesModel) {\n        const coordSys = seriesModel.coordinateSystem;\n        const data = seriesModel.getData();\n        const valueDim = data.mapDimension('value');\n        if (coordSys && coordSys.type === COMPONENT_TYPE) {\n          const center = seriesModel.get('center');\n          const point = coordSys.dataToPoint(center);\n          const cx = point[0];\n          const cy = point[1];\n          data.each(valueDim, function (value, idx) {\n            const layout = data.getItemLayout(idx);\n            layout.cx = cx;\n            layout.cy = cy;\n          });\n        }\n      });\n    });\n  }\n  // Model\n  isNewEC\n    ? registers.registerComponentModel(BingMapModel)\n    : registers.extendComponentModel(BingMapModel);\n  // View\n  isNewEC\n    ? registers.registerComponentView(BingMapView)\n    : registers.extendComponentView(BingMapView);\n  // Coordinate System\n  registers.registerCoordinateSystem(COMPONENT_TYPE, BingMapCoordSys);\n  // Action\n  registers.registerAction(\n    {\n      type: COMPONENT_TYPE + 'Roam',\n      event: COMPONENT_TYPE + 'Roam',\n      update: 'updateLayout',\n    },\n    function (payload, ecModel) {\n      ecModel.eachComponent('bingmap', function (bingMapModel) {\n        const bingmap = bingMapModel.getBingMap();\n        const center = bingmap.getCenter();\n        bingMapModel.setCenterAndZoom([center.longitude, center.latitude], bingmap.getZoom());\n      });\n    },\n  );\n}\n","import * as echarts from 'echarts'\nimport { install } from './lib/index'\nimport { isNewEC } from './lib/util'\n\nisNewEC ? echarts.use(install) : install(echarts)\n\nexport { name, version } from './lib/index'\n"],"names":["ecVer","version","split","isNewEC","COMPONENT_TYPE","BingMapModel","type","setBingMap","bingmap","this","__bingmap","getBingMap","setEChartsLayer","layer","__echartsLayer","getEChartsLayer","setCenterAndZoom","center","zoom","option","viewOption","centerOrZoomChanged","a","b","defaultOption","mapOption","customMapStyle","ComponentModel","extend","BingMapView","init","_isFirstRender","render","bingMapModel","ecModel","api","rendering","viewportRoot","getZr","painter","getViewportRoot","coordSys","coordinateSystem","viewChangeHandler","arg","offsetEl","parentNode","mapOffset","parseInt","style","left","top","setMapOffset","__mapOffset","dispatchAction","Microsoft","Maps","Events","removeHandler","_oldViewChangeHandler","addHandler","_oldmapresize","__viewChangeHandler","dispose","component","__model","ComponentView","BingMapCoordSys","_bingmap","dimensions","_mapOffset","_api","_type","dataToCoordSize","dataSize","dataItem","zrUtil","map","dimIdx","val","halfSize","p1","p2","Math","abs","dataToPoint","prototype","setZoom","_zoom","setCenter","_center","tryLocationToPixel","Location","data","lnglat","px","PixelReference","control","x","y","pointToData","pt","ptN","tryPixelToLocation","longitude","latitude","getViewRect","graphic","BoundingRect","getWidth","getHeight","getRoamTransform","matrix","create","prepareCustoms","rect","width","height","coord","bind","size","util","bingmapCoordSys","root","getDom","eachComponent","bingmapModel","Map","Error","bingmapRoot","querySelector","className","visibility","position","removeChild","document","createElement","cssText","appendChild","get","setOptions","getViewportRootOffset","offsetLeft","offsetTop","normalizedCenter","undefined","lng","lat","bingmapCenter","getCenter","bingmapZoom","getZoom","setView","eachSeries","seriesModel","install","registers","registerLayout","eachSeriesByType","getData","valueDim","mapDimension","point","cx","cy","each","value","idx","layout","getItemLayout","registerComponentModel","extendComponentModel","registerComponentView","extendComponentView","registerCoordinateSystem","registerAction","event","update","payload","echarts","use"],"mappings":"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"}